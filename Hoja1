import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import scipy.stats as stats
from scipy.stats import shapiro

movies = pd.read_csv("movies.csv", encoding='cp1252')
des = movies.transpose()

movies['releaseDate'] = pd.to_datetime(movies['releaseDate'], errors='coerce')

#Ejercicio 4.6

movies = pd.read_csv("movies.csv", encoding='cp1252')
des = movies.transpose()

fechas = movies.sort_values(by = 'releaseDate', ascending = True)

VF = fechas.tail(20)

graf = sns.countplot(x = 'genres', data = VF)
plt.xticks(rotation= 90)
plt.tight_layout()
plt.show()

#Ejercicio 4.7

MG = list(movies['genres'].value_counts().head(15).index)
GP = movies[['genres', 'revenue']]
GP = GP[GP.genres.isin(MG)]
R = []

for i in MG:
	R.append(GP.loc[(GP['genres'] == i), 'revenue'].sum())

df = pd.DataFrame(list(zip(MG, R)), columns = ['GÃ©nero','Ganancias'])
print(df)
R.clear()

df = df.sort_values(by = 'Ganancias', ascending = True)


	
